<!DOCTYPE html>
<html
  lang="pt-BR"
  xmlns:th="http://www.thymeleaf.org"
  th:replace="~{fragments/base :: layout(~{::title}, ~{::body})}"
>
  <head>
    <title th:text="#{checkin.history}">Histórico de check-ins</title>
  </head>
  <body>
    <section class="card">
      <h1 th:text="#{checkin.history}">Histórico</h1>
      
      <div
        th:if="${#lists.isEmpty(checkins)}"
        class="alert alert--info"
        th:text="#{checkin.history.empty}"
      >
        Nenhum check-in.
      </div>
      
      <div th:if="${!#lists.isEmpty(checkins)}">
        <div class="mb-3">
          <p class="text-muted mb-0">
            <span th:text="#{pagination.showing}">Mostrando</span>
            <strong th:text="${totalItems}">0</strong>
            <span th:text="#{pagination.items}">itens</span>
            <span th:if="${totalPages > 1}">
              (<span th:text="#{pagination.page}">Página</span>
              <strong th:text="${currentPage + 1}">1</strong>
              <span th:text="#{pagination.of}">de</span>
              <strong th:text="${totalPages}">1</strong>)
            </span>
          </p>
        </div>
        
        <table>
          <thead>
            <tr>
              <th th:text="#{label.date}">Data</th>
              <th th:text="#{label.mood}">Humor</th>
              <th th:text="#{label.energy}">Energia</th>
              <th th:text="#{label.sleep}">Sono</th>
              <th th:text="#{label.context}">Contexto</th>
            </tr>
          </thead>
          <tbody>
            <tr th:each="checkin : ${checkins}">
              <td th:text="${#temporals.format(checkin.data, 'dd/MM/yyyy')}">
                01/01/2025
              </td>
              <td th:text="${checkin.humor}">BEM</td>
              <td th:text="${checkin.energia}">7</td>
              <td th:text="${checkin.sono}">7</td>
              <td th:text="${checkin.contexto}">Contexto</td>
            </tr>
          </tbody>
        </table>
        
        <!-- Controles de paginação -->
        <nav th:if="${totalPages > 1}" aria-label="Navegação de páginas" class="mt-4">
          <ul class="pagination justify-content-center">
            <li class="page-item" th:classappend="${currentPage == 0} ? 'disabled'">
              <a class="page-link" th:href="@{/checkins(page=${currentPage - 1}, size=${pageSize})}" th:if="${currentPage > 0}">
                <span th:text="#{pagination.previous}">Anterior</span>
              </a>
              <span class="page-link" th:if="${currentPage == 0}">
                <span th:text="#{pagination.previous}">Anterior</span>
              </span>
            </li>
            
            <!-- Mostra página atual e algumas ao redor -->
            <li class="page-item" th:if="${currentPage > 2}">
              <a class="page-link" th:href="@{/checkins(page=0, size=${pageSize})}">1</a>
            </li>
            <li class="page-item disabled" th:if="${currentPage > 2}">
              <span class="page-link">...</span>
            </li>
            
            <li th:each="i : ${#numbers.sequence(
                T(java.lang.Math).max(0, currentPage - 1),
                T(java.lang.Math).min(totalPages - 1, currentPage + 1)
            )}" 
                class="page-item" th:classappend="${i == currentPage} ? 'active'">
              <a class="page-link" th:href="@{/checkins(page=${i}, size=${pageSize})}" th:text="${i + 1}">1</a>
            </li>
            
            <li class="page-item disabled" th:if="${currentPage < totalPages - 2}">
              <span class="page-link">...</span>
            </li>
            <li class="page-item" th:if="${currentPage < totalPages - 2}">
              <a class="page-link" th:href="@{/checkins(page=${totalPages - 1}, size=${pageSize})}" th:text="${totalPages}"></a>
            </li>
            
            <li class="page-item" th:classappend="${currentPage >= totalPages - 1} ? 'disabled'">
              <a class="page-link" th:href="@{/checkins(page=${currentPage + 1}, size=${pageSize})}" th:if="${currentPage < totalPages - 1}">
                <span th:text="#{pagination.next}">Próxima</span>
              </a>
              <span class="page-link" th:if="${currentPage >= totalPages - 1}">
                <span th:text="#{pagination.next}">Próxima</span>
              </span>
            </li>
          </ul>
        </nav>
      </div>
    </section>
  </body>
</html>
